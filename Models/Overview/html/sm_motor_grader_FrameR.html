<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
<META http-equiv="Content-Type" content="text/html; charset=UTF-8">
<!--
This HTML was auto-generated from MATLAB code.
To make changes, update the MATLAB code and republish this document.
      -->
<title>Motor Grader Rear Frame</title>
<meta name="generator" content="MATLAB 24.2">
<link rel="schema.DC" href="http://purl.org/dc/elements/1.1/">
<meta name="DC.date" content="2025-03-26">
<meta name="DC.source" content="sm_motor_grader_FrameR.m">
<style type="text/css">
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{margin:0;padding:0;border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent}body{line-height:1}ol,ul{list-style:none}blockquote,q{quotes:none}blockquote:before,blockquote:after,q:before,q:after{content:'';content:none}:focus{outine:0}ins{text-decoration:none}del{text-decoration:line-through}table{border-collapse:collapse;border-spacing:0}

html { min-height:100%; margin-bottom:1px; }
html body { height:100%; margin:0px; font-family:Arial, Helvetica, sans-serif; font-size:10px; color:#000; line-height:140%; background:#fff none; overflow-y:scroll; }
html body td { vertical-align:top; text-align:left; }

h1 { padding:0px; margin:0px 0px 25px; font-family:Arial, Helvetica, sans-serif; font-size:1.5em; color:#d55000; line-height:100%; font-weight:normal; }
h2 { padding:0px; margin:0px 0px 8px; font-family:Arial, Helvetica, sans-serif; font-size:1.2em; color:#000; font-weight:bold; line-height:140%; border-bottom:1px solid #d6d4d4; display:block; }
h3 { padding:0px; margin:0px 0px 5px; font-family:Arial, Helvetica, sans-serif; font-size:1.1em; color:#000; font-weight:bold; line-height:140%; }

a { color:#005fce; text-decoration:none; }
a:hover { color:#005fce; text-decoration:underline; }
a:visited { color:#004aa0; text-decoration:none; }

p { padding:0px; margin:0px 0px 20px; }
img { padding:0px; margin:0px 0px 20px; border:none; }
p img, pre img, tt img, li img, h1 img, h2 img { margin-bottom:0px; }

ul { padding:0px; margin:0px 0px 20px 23px; list-style:square; }
ul li { padding:0px; margin:0px 0px 7px 0px; }
ul li ul { padding:5px 0px 0px; margin:0px 0px 7px 23px; }
ul li ol li { list-style:decimal; }
ol { padding:0px; margin:0px 0px 20px 0px; list-style:decimal; }
ol li { padding:0px; margin:0px 0px 7px 23px; list-style-type:decimal; }
ol li ol { padding:5px 0px 0px; margin:0px 0px 7px 0px; }
ol li ol li { list-style-type:lower-alpha; }
ol li ul { padding-top:7px; }
ol li ul li { list-style:square; }

.content { font-size:1.2em; line-height:140%; padding: 20px; }

pre, code { font-size:12px; }
tt { font-size: 1.2em; }
pre { margin:0px 0px 20px; }
pre.codeinput { padding:10px; border:1px solid #d3d3d3; background:#f7f7f7; }
pre.codeoutput { padding:10px 11px; margin:0px 0px 20px; color:#4c4c4c; }
pre.error { color:red; }

@media print { pre.codeinput, pre.codeoutput { word-wrap:break-word; width:100%; } }

span.keyword { color:#0000FF }
span.comment { color:#228B22 }
span.string { color:#A020F0 }
span.untermstring { color:#B20000 }
span.syscmd { color:#B28C00 }
span.typesection { color:#A0522D }

.footer { width:auto; padding:10px 0px; margin:25px 0px 0px; border-top:1px dotted #878787; font-size:0.8em; line-height:140%; font-style:italic; color:#878787; text-align:left; float:none; }
.footer p { margin:0px; }
.footer a { color:#878787; }
.footer a:hover { color:#878787; text-decoration:underline; }
.footer a:visited { color:#878787; }

table th { padding:7px 5px; text-align:left; vertical-align:middle; border: 1px solid #d6d4d4; font-weight:bold; }
table td { padding:7px 5px; text-align:left; vertical-align:top; border:1px solid #d6d4d4; }





  </style>
</head>
<body>
<div class="content">
<h1>Motor Grader Rear Frame</h1>
<!--introduction-->
<p>
<img vspace="5" hspace="5" src="sm_motor_grader_FrameR_Overview.png" alt=""> </p>
<p>This example models the rear frame of a motor grader. An abstract torque source drives the wheels.</p>
<p>(<a href="matlab:web('Motor_Grader_Design_Overview.html')">return to Motor Grader Design with Simscape Overview</a>)</p>
<!--/introduction-->
<h2>Contents</h2>
<div>
<ul>
<li>
<a href="#1">Model</a>
</li>
<li>
<a href="#2">Rear Frame Model</a>
</li>
<li>
<a href="#3">Powertrain: Torque at Wheels</a>
</li>
<li>
<a href="#4">Powertrain: Torque at Driveline</a>
</li>
<li>
<a href="#5">Powertrain: Driveline</a>
</li>
<li>
<a href="#6">Tire: Spherical</a>
</li>
<li>
<a href="#7">Tire: Magic Formula</a>
</li>
<li>
<a href="#8">Tire: Point Cloud</a>
</li>
<li>
<a href="#9">Simulation Results: Spherical Tires</a>
</li>
<li>
<a href="#10">Simulation Results: Magic Formula Tires</a>
</li>
<li>
<a href="#11">Simulation Results: Point Cloud Tires, Cylinder</a>
</li>
<li>
<a href="#12">Simulation Results: Point Cloud Tires, Outer Tread</a>
</li>
<li>
<a href="#13">Simulation Results: Point Cloud Tires, Convex Hull</a>
</li>
<li>
<a href="#14">Comparison of Results for Tire Models</a>
</li>
<li>
<a href="#15">Simulation Results: Driveline</a>
</li>
<li>
<a href="#16">Simulation Results: CVT Abstract</a>
</li>
<li>
<a href="#17">Simulation Results: CVT Electrical</a>
</li>
<li>
<a href="#18">Simulation Results: CVT Hydrostatic</a>
</li>
<li>
<a href="#19">Simulation Results: CVT Power Split</a>
</li>
<li>
<a href="#20">Comparison of Results for Powertrain Models</a>
</li>
</ul>
</div>
<h2 id="1">Model</h2>
<p>
<a href="matlab:open_system('sm_motor_grader_FrameR');">Open Model</a>
</p>
<img vspace="5" hspace="5" src="sm_motor_grader_FrameR_01.png" alt=""> <h2 id="2">Rear Frame Model</h2>
<p>The rear frame models the inertia for the drive unit for the rear wheels, including the power source for the powertrain. The connection between the wheels and the powertrain are the 1D mechanical ports FL, FR, RL, and RR. The mechanical connection between the wheels, including the components such as differentials, is handled within the powertrain subsystem.</p>
<p>
<a href="matlab:open_system('sm_motor_grader_FrameR');open_system('sm_motor_grader_FrameR/Frame%20Rear','force');">Open Subsystem</a>
</p>
<img vspace="5" hspace="5" src="sm_motor_grader_FrameR_02.png" alt=""> <h2 id="3">Powertrain: Torque at Wheels</h2>
<p>The model below shows ideal torque sources that apply torque to each wheel. This abstract model does not attempt to capture powertrain behavior, it is a very simple model that simply acts to get the vehicle to travel at the target speed. Minimizing computation in the powertrain system lets the model run faster.</p>
<p>
<a href="matlab:open_system('sm_motor_grader_FrameR');open_system('sm_motor_grader_FrameR/Powertrain/Torque4','force');">Open Subsystem</a>
</p>
<img vspace="5" hspace="5" src="sm_motor_grader_FrameR_03.png" alt=""> <h2 id="4">Powertrain: Torque at Driveline</h2>
<p>The model below shows an ideal torque source that applies torque to the input shaft of the mechanical driveline. This abstract model assumes the engine and CVT perform as required and lets the investigation focus on the driveline and on the tire-ground interaction.</p>
<p>
<a href="matlab:open_system('sm_motor_grader_FrameR');open_system('sm_motor_grader_FrameR/Powertrain/Torque1','force');">Open Subsystem</a>
</p>
<img vspace="5" hspace="5" src="sm_motor_grader_FrameR_04.png" alt=""> <h2 id="5">Powertrain: Driveline</h2>
<p>The model below represents the mechanical connection between the output of the transmission and the four driven wheels. Differentials at the front and rear enable the engine to power both wheels and for those wheels to turn at different rates when the vehicle is in a turn. Compliance elements abstractly model shaft deflection in the driveline.</p>
<p>
<a href="matlab:open_system('sm_motor_grader_FrameR');open_system('sm_motor_grader_FrameR/Powertrain/Torque1/Driveline','force');">Open Subsystem</a>
</p>
<img vspace="5" hspace="5" src="sm_motor_grader_FrameR_05.png" alt=""> <h2 id="6">Tire: Spherical</h2>
<p>This tire model uses the Spatial Contact Force block to model normal and friction forces between the tire and the ground. The geometry of the tire is abstractly represented as a sphere to minimize computation. A generic force law is used in the Spatial Contact Force block. Custom force laws can be integrated with this block where the block measures quantities such as relative location, velocity, and tangential velocity so that you can calculate the forces and torques on the wheel.</p>
<p>
<a href="matlab:open_system('sm_motor_grader_FrameR');open_system('sm_motor_grader_FrameR/Frame%20Rear/Wheel%20FL/Contact/Sphere','force');">Open Subsystem</a>
</p>
<img vspace="5" hspace="5" src="sm_motor_grader_FrameR_06.png" alt=""> <h2 id="7">Tire: Magic Formula</h2>
<p>This tire model uses the Magic Formula Tire Force and Torque block to model forces and torques acting between the tire and the ground. The geometry of the tire is abstractly represented as a ring in the central plane of the tire. The Magic Formula Tire equations are used to calculate the forces and torques. See also the Custom Tire Force and Torque block for custom tire models.</p>
<p>
<a href="matlab:open_system('sm_motor_grader_FrameR');open_system('sm_motor_grader_FrameR/Frame%20Rear/Wheel%20FL/Contact/Magic%20Formula','force');Open">Subsystem</a>
</p>
<img vspace="5" hspace="5" src="sm_motor_grader_FrameR_07.png" alt=""> <h2 id="8">Tire: Point Cloud</h2>
<p>This tire model uses the Spatial Contact Force block to model normal and friction forces between the tire and the ground. The geometry of the tire is represented as a point cloud which permits arbitrary tire profiles. A generic force law is used in the Spatial Contact Force block. Custom force laws can be integrated with this block where the block measures quantities such as relative location, velocity, and tangential velocity so that you can calculate the forces and torques on the wheel. The performance of this block depends heavily on the number and location of the points in the point cloud.</p>
<p>
<a href="matlab:open_system('sm_motor_grader_FrameR');open_system('sm_motor_grader_FrameR/Frame%20Rear/Wheel%20FL/Contact/Point%20Cloud','force');">Open Subsystem</a>
</p>
<img vspace="5" hspace="5" src="sm_motor_grader_FrameR_08.png" alt=""> <h2 id="9">Simulation Results: Spherical Tires</h2>
<p>The results below were generated by a simulation with a simple acceleration and deceleration. In this test, the Spatial Contact Force block with sphere geometry for the tire was used.</p>
<img vspace="5" hspace="5" src="sm_motor_grader_FrameR_09.png" alt=""> <h2 id="10">Simulation Results: Magic Formula Tires</h2>
<p>The results below were generated by a simulation with a simple acceleration and deceleration. In this test, the Magic Formula Tire was used.</p>
<img vspace="5" hspace="5" src="sm_motor_grader_FrameR_10.png" alt=""> <h2 id="11">Simulation Results: Point Cloud Tires, Cylinder</h2>
<p>The results below were generated by a simulation with a simple acceleration and deceleration. In this test, the Spatial Contact Force block with point cloud geometry for the tire was used. The point cloud distributes the points evenly on a cylinder whose surface is at a single fixed radius at the surface of the tire.</p>
<img vspace="5" hspace="5" src="sm_motor_grader_FrameR_11.png" alt=""> <h2 id="12">Simulation Results: Point Cloud Tires, Outer Tread</h2>
<p>The results below were generated by a simulation with a simple acceleration and deceleration. In this test, the Spatial Contact Force block with point cloud geometry for the tire was used. The points in the point cloud were extracted from the CAD geometry for the tire and only includes points outside a specified radius.</p>
<img vspace="5" hspace="5" src="sm_motor_grader_FrameR_12.png" alt=""> <h2 id="13">Simulation Results: Point Cloud Tires, Convex Hull</h2>
<p>The results below were generated by a simulation with a simple acceleration and deceleration. In this test, the Spatial Contact Force block with point cloud geometry for the tire was used. The points in the point cloud were extracted from the CAD geometry for the tire and only includes points on the surface of a convex hull for the tire.</p>
<img vspace="5" hspace="5" src="sm_motor_grader_FrameR_13.png" alt=""> <h2 id="14">Comparison of Results for Tire Models</h2>
<p>This plot shows the speed of the front left wheel on the rear frame with each of the different tire models. The point cloud tires show oscillations in speed. The point cloud tires capture the rugged profile of the tire, and on hard surfaces these vibrations will be transmitted back through the driveline system.</p>
<img vspace="5" hspace="5" src="sm_motor_grader_FrameR_14.png" alt=""> <h2 id="15">Simulation Results: Driveline</h2>
<p>The results below were generated by a simulation with a simple acceleration and deceleration. In this test, the Magic Formula Tire was used and the wheels are connected via a mechanical driveline with front and rear differentials.</p>
<img vspace="5" hspace="5" src="sm_motor_grader_FrameR_15.png" alt=""> <h2 id="16">Simulation Results: CVT Abstract</h2>
<p>The results below were generated by a simulation with a simple acceleration and deceleration. In this test, the Magic Formula Tire was used and the wheels are connected via a mechanical driveline with front and rear differentials and powered by an engine via an abstract CVT.</p>
<img vspace="5" hspace="5" src="sm_motor_grader_FrameR_16.png" alt=""> <h2 id="17">Simulation Results: CVT Electrical</h2>
<p>The results below were generated by a simulation with a simple acceleration and deceleration. In this test, the Magic Formula Tire was used and the wheels are connected via a mechanical driveline with front and rear differentials and powered by an engine via an electrical CVT.</p>
<img vspace="5" hspace="5" src="sm_motor_grader_FrameR_17.png" alt=""> <h2 id="18">Simulation Results: CVT Hydrostatic</h2>
<p>The results below were generated by a simulation with a simple acceleration and deceleration. In this test, the Magic Formula Tire was used and the wheels are connected via a mechanical driveline with front and rear differentials and powered by an engine via an hydrostatic CVT.</p>
<img vspace="5" hspace="5" src="sm_motor_grader_FrameR_18.png" alt=""> <h2 id="19">Simulation Results: CVT Power Split</h2>
<p>The results below were generated by a simulation with a simple acceleration and deceleration. In this test, the Magic Formula Tire was used and the wheels are connected via a mechanical driveline with front and rear differentials and powered by an engine via a power split hydromechanical CVT.</p>
<img vspace="5" hspace="5" src="sm_motor_grader_FrameR_19.png" alt=""> <h2 id="20">Comparison of Results for Powertrain Models</h2>
<p>This plot shows the speed of the front left wheel on the rear frame with each of the different transmission models. The shift changes in the power-split transmission are visible, as are the responsiveness of the control system for each type of CVT.</p>
<img vspace="5" hspace="5" src="sm_motor_grader_FrameR_20.png" alt=""> <p class="footer">Copyright 2025 The MathWorks, Inc.<br>
<a href="https://www.mathworks.com/products/matlab/">Published with MATLAB&reg; R2024b</a>
<br>
</p>
</div>
<!--
##### SOURCE BEGIN #####
%% Motor Grader Rear Frame
% 
% <<sm_motor_grader_FrameR_Overview.png>>
%
% This example models the rear frame of a motor grader.  An abstract
% torque source drives the wheels.
%
% (<matlab:web('Motor_Grader_Design_Overview.html') return to Motor Grader Design with Simscape Overview>)
%
% Copyright 2025 The MathWorks, Inc.

%% Model
%
% <matlab:open_system('sm_motor_grader_FrameR'); Open Model>

open_system('sm_motor_grader_FrameR')

ann_h = find_system('sm_motor_grader_FrameR','MatchFilter',@Simulink.match.allVariants,'FindAll', 'on','type','annotation','Tag','ModelFeatures');
for i = 1:length(ann_h)
    set_param(ann_h(i),'Interpreter','off')
end

%% Rear Frame Model
%
% The rear frame models the inertia for the drive unit for the rear wheels,
% including the power source for the powertrain. The connection between the
% wheels and the powertrain are the 1D mechanical ports FL, FR, RL, and RR.
% The mechanical connection between the wheels, including the components
% such as differentials, is handled within the powertrain subsystem.
%
% <matlab:open_system('sm_motor_grader_FrameR');open_system('sm_motor_grader_FrameR/Frame%20Rear','force'); Open Subsystem>

set_param('sm_motor_grader_FrameR/Frame Rear','LinkStatus','none')
open_system('sm_motor_grader_FrameR/Frame Rear','force')

%% Powertrain: Torque at Wheels
%
% The model below shows ideal torque sources that apply torque to each
% wheel.  This abstract model does not attempt to capture powertrain
% behavior, it is a very simple model that simply acts to get the vehicle
% to travel at the target speed.  Minimizing computation in the powertrain
% system lets the model run faster.
%
% <matlab:open_system('sm_motor_grader_FrameR');open_system('sm_motor_grader_FrameR/Powertrain/Torque4','force'); Open Subsystem>

set_param('sm_motor_grader_FrameR/Powertrain','popup_powertrain_config','Wheels')
set_param('sm_motor_grader_FrameR', 'SimulationCommand', 'update')
set_param('sm_motor_grader_FrameR/Powertrain','LinkStatus','none')
set_param('sm_motor_grader_FrameR/Powertrain/Torque4','LinkStatus','none')
open_system('sm_motor_grader_FrameR/Powertrain/Torque4','force')

%% Powertrain: Torque at Driveline
%
% The model below shows an ideal torque source that applies torque to the
% input shaft of the mechanical driveline.  This abstract model assumes the
% engine and CVT perform as required and lets the investigation focus on
% the driveline and on the tire-ground interaction.
%
% <matlab:open_system('sm_motor_grader_FrameR');open_system('sm_motor_grader_FrameR/Powertrain/Torque1','force'); Open Subsystem>

set_param('sm_motor_grader_FrameR/Powertrain','popup_powertrain_config','Driveline')
set_param('sm_motor_grader_FrameR', 'SimulationCommand', 'update')
set_param('sm_motor_grader_FrameR/Powertrain/Torque1','LinkStatus','none')
open_system('sm_motor_grader_FrameR/Powertrain/Torque1','force')

%% Powertrain: Driveline
%
% The model below represents the mechanical connection between the output
% of the transmission and the four driven wheels.  Differentials at the
% front and rear enable the engine to power both wheels and for those
% wheels to turn at different rates when the vehicle is in a turn.
% Compliance elements abstractly model shaft deflection in the driveline.
%
% <matlab:open_system('sm_motor_grader_FrameR');open_system('sm_motor_grader_FrameR/Powertrain/Torque1/Driveline','force'); Open Subsystem>

set_param('sm_motor_grader_FrameR/Powertrain/Torque1/Driveline','LinkStatus','none')
open_system('sm_motor_grader_FrameR/Powertrain/Torque1/Driveline','force')


%% Tire: Spherical
%
% This tire model uses the Spatial Contact Force block to model normal and
% friction forces between the tire and the ground.  The geometry of the
% tire is abstractly represented as a sphere to minimize computation. A
% generic force law is used in the Spatial Contact Force block.  Custom
% force laws can be integrated with this block where the block measures
% quantities such as relative location, velocity, and tangential velocity
% so that you can calculate the forces and torques on the wheel.
%
% <matlab:open_system('sm_motor_grader_FrameR');open_system('sm_motor_grader_FrameR/Frame%20Rear/Wheel%20FL/Contact/Sphere','force'); Open Subsystem>

set_param('sm_motor_grader_FrameR/Frame Rear','popup_ground_contact','Sphere');
set_param('sm_motor_grader_FrameR', 'SimulationCommand', 'update')
set_param('sm_motor_grader_FrameR/Frame Rear/Wheel FL/Contact/Sphere','LinkStatus','none')
open_system('sm_motor_grader_FrameR/Frame Rear/Wheel FL/Contact/Sphere','force')

%% Tire: Magic Formula
%
% This tire model uses the Magic Formula Tire Force and Torque block to
% model forces and torques acting between the tire and the ground.  The
% geometry of the tire is abstractly represented as a ring in the central
% plane of the tire. The Magic Formula Tire equations are used to calculate
% the forces and torques.  See also the Custom Tire Force and Torque block
% for custom tire models.
%
% <matlab:open_system('sm_motor_grader_FrameR');open_system('sm_motor_grader_FrameR/Frame%20Rear/Wheel%20FL/Contact/Magic%20Formula','force');Open Subsystem>

set_param('sm_motor_grader_FrameR/Frame Rear','popup_ground_contact','Magic Formula');
set_param('sm_motor_grader_FrameR', 'SimulationCommand', 'update')
set_param('sm_motor_grader_FrameR/Frame Rear/Wheel FL/Contact/Magic Formula','LinkStatus','none')
open_system('sm_motor_grader_FrameR/Frame Rear/Wheel FL/Contact/Magic Formula','force')

%% Tire: Point Cloud
%
% This tire model uses the Spatial Contact Force block to model normal and
% friction forces between the tire and the ground.  The geometry of the
% tire is represented as a point cloud which permits arbitrary tire profiles. A
% generic force law is used in the Spatial Contact Force block.  Custom
% force laws can be integrated with this block where the block measures
% quantities such as relative location, velocity, and tangential velocity
% so that you can calculate the forces and torques on the wheel. The
% performance of this block depends heavily on the number and location of
% the points in the point cloud.
%
% <matlab:open_system('sm_motor_grader_FrameR');open_system('sm_motor_grader_FrameR/Frame%20Rear/Wheel%20FL/Contact/Point%20Cloud','force'); Open Subsystem>

set_param('sm_motor_grader_FrameR/Frame Rear','popup_ground_contact','Point Cloud');
set_param('sm_motor_grader_FrameR', 'SimulationCommand', 'update')
set_param('sm_motor_grader_FrameR/Frame Rear/Wheel FL/Contact/Point Cloud','LinkStatus','none')
open_system('sm_motor_grader_FrameR/Frame Rear/Wheel FL/Contact/Point Cloud','force')

%% Simulation Results: Spherical Tires
%
% The results below were generated by a simulation with a simple
% acceleration and deceleration.  In this test, the Spatial Contact Force
% block with sphere geometry for the tire was used.

set_param('sm_motor_grader_FrameR/Powertrain','popup_powertrain_config','Wheels')
set_param('sm_motor_grader_FrameR/Frame Rear','popup_ground_contact','Sphere')
sim('sm_motor_grader_FrameR')

[~, resSp] = sm_motor_grader_plot1whlspd(logsout_sm_motor_grader_FrameR,motGradParams.groundContact.tireRad,motGradParams.groundContact.tireRad);
text(0.05,0.95,[num2str(length(tout)) ' Steps'],'Units','normalized','Color',[0.6 0.6 0.6])

%% Simulation Results: Magic Formula Tires
%
% The results below were generated by a simulation with a simple
% acceleration and deceleration.  In this test, the Magic Formula Tire was used.

set_param('sm_motor_grader_FrameR/Frame Rear','popup_ground_contact','Magic Formula')
sim('sm_motor_grader_FrameR')

[~, resMF] = sm_motor_grader_plot1whlspd(logsout_sm_motor_grader_FrameR,motGradParams.groundContact.tireRad,motGradParams.groundContact.tireRad);
text(0.05,0.95,[num2str(length(tout)) ' Steps'],'Units','normalized','Color',[0.6 0.6 0.6])

%% Simulation Results: Point Cloud Tires, Cylinder
%
% The results below were generated by a simulation with a simple
% acceleration and deceleration.  In this test, the Spatial Contact Force
% block with point cloud geometry for the tire was used.  The point cloud
% distributes the points evenly on a cylinder whose surface is at a single
% fixed radius at the surface of the tire.

set_param('sm_motor_grader_FrameR/Frame Rear','popup_ground_contact','Point Cloud')
motGradParams.tire.ptcld = motGradParams.tire.ptcld_cyl;
sim('sm_motor_grader_FrameR')

[~, resCy] = sm_motor_grader_plot1whlspd(logsout_sm_motor_grader_FrameR,motGradParams.groundContact.tireRad,motGradParams.groundContact.tireRad);
text(0.05,0.95,[num2str(length(tout)) ' Steps'],'Units','normalized','Color',[0.6 0.6 0.6])

%% Simulation Results: Point Cloud Tires, Outer Tread
%
% The results below were generated by a simulation with a simple
% acceleration and deceleration.  In this test, the Spatial Contact Force
% block with point cloud geometry for the tire was used.  The points in the
% point cloud were extracted from the CAD geometry for the tire and only
% includes points outside a specified radius.


set_param('sm_motor_grader_FrameR/Frame Rear','popup_ground_contact','Point Cloud')
motGradParams.tire.ptcld = motGradParams.tire.ptcld_loc;
sim('sm_motor_grader_FrameR')

[~, resTr] = sm_motor_grader_plot1whlspd(logsout_sm_motor_grader_FrameR,motGradParams.groundContact.tireRad,motGradParams.groundContact.tireRad);
text(0.05,0.95,[num2str(length(tout)) ' Steps'],'Units','normalized','Color',[0.6 0.6 0.6])

%% Simulation Results: Point Cloud Tires, Convex Hull
%
% The results below were generated by a simulation with a simple
% acceleration and deceleration.  In this test, the Spatial Contact Force
% block with point cloud geometry for the tire was used.  The points in the
% point cloud were extracted from the CAD geometry for the tire and only
% includes points on the surface of a convex hull for the tire.


set_param('sm_motor_grader_FrameR/Frame Rear','popup_ground_contact','Point Cloud')
motGradParams.tire.ptcld = motGradParams.tire.ptcld_hull;
sim('sm_motor_grader_FrameR')

[~, resHu] = sm_motor_grader_plot1whlspd(logsout_sm_motor_grader_FrameR,motGradParams.groundContact.tireRad,motGradParams.groundContact.tireRad);
text(0.05,0.95,[num2str(length(tout)) ' Steps'],'Units','normalized','Color',[0.6 0.6 0.6])

%% Comparison of Results for Tire Models
%
% This plot shows the speed of the front left wheel on the rear frame with
% each of the different tire models.  The point cloud tires show
% oscillations in speed.  The point cloud tires capture the rugged profile
% of the tire, and on hard surfaces these vibrations will be transmitted
% back through the driveline system.

figure
plot(resSp.t,resSp.vRFL,'LineWidth',1,'DisplayName','Sphere');
hold on
plot(resMF.t,resMF.vRFL,'LineWidth',1,'DisplayName','Magic Formula');
plot(resCy.t,resCy.vRFL,'LineWidth',1,'DisplayName','Cylinder');
plot(resHu.t,resHu.vRFL,'LineWidth',1,'DisplayName','Hull');
plot(resTr.t,resTr.vRFL,'LineWidth',1,'DisplayName','Tread');
hold off
ylabel('Speed (m/s)')
xlabel('Time (s)')
title('Wheel Speeds and Vehicle Speed')
grid on
legend('Location','Best');
box on
axis([7.5 9.5 5.2 6.2])

%% Simulation Results: Driveline
%
% The results below were generated by a simulation with a simple
% acceleration and deceleration.  In this test, the Magic Formula Tire was
% used and the wheels are connected via a mechanical driveline with front
% and rear differentials.

set_param('sm_motor_grader_FrameR/Powertrain','popup_powertrain_config','Driveline')
set_param('sm_motor_grader_FrameR/Frame Rear','popup_ground_contact','Magic Formula')
sim('sm_motor_grader_FrameR')

[~, resMFDr] = sm_motor_grader_plot1whlspd(logsout_sm_motor_grader_FrameR,motGradParams.groundContact.tireRad,motGradParams.groundContact.tireRad);
text(0.05,0.95,[num2str(length(tout)) ' Steps'],'Units','normalized','Color',[0.6 0.6 0.6])

%% Simulation Results: CVT Abstract
%
% The results below were generated by a simulation with a simple
% acceleration and deceleration.  In this test, the Magic Formula Tire was
% used and the wheels are connected via a mechanical driveline with front
% and rear differentials and powered by an engine via an abstract CVT.

set_param('sm_motor_grader_FrameR/Powertrain','popup_powertrain_config','CVT Abstract')
set_param('sm_motor_grader_FrameR/Frame Rear','popup_ground_contact','Magic Formula')
sim('sm_motor_grader_FrameR')

[~, resMFAb] = sm_motor_grader_plot1whlspd(logsout_sm_motor_grader_FrameR,motGradParams.groundContact.tireRad,motGradParams.groundContact.tireRad);
text(0.05,0.95,[num2str(length(tout)) ' Steps'],'Units','normalized','Color',[0.6 0.6 0.6])

%% Simulation Results: CVT Electrical
%
% The results below were generated by a simulation with a simple
% acceleration and deceleration.  In this test, the Magic Formula Tire was
% used and the wheels are connected via a mechanical driveline with front
% and rear differentials and powered by an engine via an electrical CVT.

set_param('sm_motor_grader_FrameR/Powertrain','popup_powertrain_config','CVT Electrical')
set_param('sm_motor_grader_FrameR/Frame Rear','popup_ground_contact','Magic Formula')
sim('sm_motor_grader_FrameR')

[~, resMFEl] = sm_motor_grader_plot1whlspd(logsout_sm_motor_grader_FrameR,motGradParams.groundContact.tireRad,motGradParams.groundContact.tireRad);
text(0.05,0.95,[num2str(length(tout)) ' Steps'],'Units','normalized','Color',[0.6 0.6 0.6])

%% Simulation Results: CVT Hydrostatic
%
% The results below were generated by a simulation with a simple
% acceleration and deceleration.  In this test, the Magic Formula Tire was
% used and the wheels are connected via a mechanical driveline with front
% and rear differentials and powered by an engine via an hydrostatic CVT.

set_param('sm_motor_grader_FrameR/Powertrain','popup_powertrain_config','CVT Hydrostatic')
set_param('sm_motor_grader_FrameR/Frame Rear','popup_ground_contact','Magic Formula')
sim('sm_motor_grader_FrameR')

[~, resMFHy] = sm_motor_grader_plot1whlspd(logsout_sm_motor_grader_FrameR,motGradParams.groundContact.tireRad,motGradParams.groundContact.tireRad);
text(0.05,0.95,[num2str(length(tout)) ' Steps'],'Units','normalized','Color',[0.6 0.6 0.6])

%% Simulation Results: CVT Power Split
%
% The results below were generated by a simulation with a simple
% acceleration and deceleration.  In this test, the Magic Formula Tire was
% used and the wheels are connected via a mechanical driveline with front
% and rear differentials and powered by an engine via a power split
% hydromechanical CVT.

set_param('sm_motor_grader_FrameR/Powertrain','popup_powertrain_config','CVT Power Split HM')
set_param('sm_motor_grader_FrameR/Frame Rear','popup_ground_contact','Magic Formula')
sim('sm_motor_grader_FrameR')

[~, resMFPS] = sm_motor_grader_plot1whlspd(logsout_sm_motor_grader_FrameR,motGradParams.groundContact.tireRad,motGradParams.groundContact.tireRad);
text(0.05,0.95,[num2str(length(tout)) ' Steps'],'Units','normalized','Color',[0.6 0.6 0.6])

%% Comparison of Results for Powertrain Models
%
% This plot shows the speed of the front left wheel on the rear frame with
% each of the different transmission models.  The shift changes in the
% power-split transmission are visible, as are the responsiveness of the
% control system for each type of CVT.

figure
plot(resMFDr.t,resMFDr.vRFL,'LineWidth',1,'DisplayName','Driveline');
hold on
plot(resMFAb.t,resMFAb.vRFL,'LineWidth',1,'DisplayName','CVT Abstract');
plot(resMFEl.t,resMFEl.vRFL,'LineWidth',1,'DisplayName','CVT Electrical');
plot(resMFHy.t,resMFHy.vRFL,'LineWidth',1,'DisplayName','CVT Hydrostatic');
plot(resMFPS.t,resMFPS.vRFL,'LineWidth',1,'DisplayName','CVT Power Split');
hold off
ylabel('Speed (m/s)')
xlabel('Time (s)')
title('Wheel Speeds and Vehicle Speed')
grid on
legend('Location','Best');
box on

%%

%clear all
close all
bdclose all

##### SOURCE END #####
-->
</body>
</html>
